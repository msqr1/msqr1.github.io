<!doctype html><html lang=en><meta charset=UTF-8 content="width=device-width,initial-scale=1" name=viewport><title>Vosklet Demo</title><script defer src=https://cdn.jsdelivr.net/gh/msqr1/Vosklet@1.1.4/Examples/Vosklet.min.js></script><link rel="icon" type="image/x-icon" href="https://cdn.jsdelivr.net/gh/msqr1/msqr1.github.io/favicon.ico"><style>body{font-size:1.3rem;box-sizing:border-box}button,input,select{vertical-align:middle;font-size:1rem}#loadBtn{margin-right:1.25rem}#spkBtn{text-align:center;padding:5px}#micOff,#micOn{width:1.6rem;height:1.6rem}#cacheTbl,#micOn{display:none}h1,h3{text-align:center}#result{border:1px solid grey;width:100%;overflow-wrap:break-word;white-space:normal;min-height:1.56rem}#result>span{white-space:normal;color:grey}#flexbox{--gap:1.5%;justify-content:center;display:flex;flex-wrap:wrap;column-gap:var(--gap)}#flexbox>div{width:100%}@media (width > 991px){#flexbox>div{width:calc(50% - var(--gap)/ 2)}}#flexbox>div>div{margin-bottom:1.2rem}table{background:#000;width:100%}td{background:#fff}th{background:#d3d3d3}.delete{text-align:center}.delete:hover{background:#ffbdbd}</style><h1>Vosklet 1.1.4 Demo</h1><div id=flexbox><div><h3>Speech Recognition</h3><div><label for=langPick>Language:</label> <select id=langPick><option value=vosk-model-small-en-us-0.15_>English<option value=vosk-model-small-en-in-0.4_>Indian English<option value=vosk-model-small-cn-0.3_>Chinese<option value=vosk-model-small-ru-0.4_>Russian<option value=vosk-model-small-fr-pguyot-0.3_>French<option value=vosk-model-small-de-0.15_>German<option value=vosk-model-small-ca-0.4_>Catalan<option value=vosk-model-small-pt-0.3_>Portuguese<option value=vosk-model-small-tr-0.3_>Turkish<option value=vosk-model-small-it-0.4_>Italian<option value=vosk-model-small-es-0.42>Spanish<option value=vosk-model-small-vn-0.4>Vietnamese<option value=vosk-model-small-nl-0.22>Dutch<option value=vosk-model-small-fa-0.5>Farsi<option value=vosk-model-small-kz-0.15>Kazakh<option value=vosk-model-small-ja-0.22>Japanese<option value=vosk-model-small-hi-0.22>Hindi<option value=vosk-model-small-cs-0.4-rhasspy>Czech<option value=vosk-model-small-uz-0.22>Uzbek<option value=vosk-model-small-ko-0.22>Korean<option value=vosk-model-small-tg-0.22>Tajik</select> <button id=loadBtn>Load</button> <label for=cacheBtn>Show model cache:</label> <input id=cacheBtn type=checkbox></div><div><label for=spkBtn>Toggle microphone:</label> <button id=spkBtn disabled><img id=micOn src=https://cdn.jsdelivr.net/gh/msqr1/msqr1.github.io/Vosklet/micOn.svg><img id=micOff src=https://cdn.jsdelivr.net/gh/msqr1/msqr1.github.io/Vosklet/micOff.svg></button></div><div><label for=uploadBtn>Upload audio:</label> <input id=uploadBtn type=file disabled multiple> <button id=processBtn disabled>Process</button></div><div><label for=clrBtn>Result text:</label> <button id=clrBtn>Clear</button></div><div id=result><span></span></div></div><div id=cacheTbl><h3>Cached Models</h3><table><thead><tr><th>Path<th>ID<th>Delete (click)<tbody></table></div></div><script>'use strict';document.addEventListener("DOMContentLoaded",async()=>{async function u(){await v.removeEntry(this.parentNode.firstChild.textContent,{recursive:!0});d.removeChild(this.parentNode)}let d=document.getElementsByTagName("tbody")[0];var b=document.getElementById.bind(document);let C=b("cacheTbl"),w=b("cacheBtn"),x=b("langPick"),n=b("loadBtn"),k=b("uploadBtn"),p=b("processBtn"),q=b("spkBtn"),D=b("clrBtn"),h=b("micOn"),r=b("micOff"),l=b("result"),y=l.lastChild,v=await navigator.storage.getDirectory(),t=await loadVosklet(),e=new AudioContext({sinkId:{type:"none"},latencyHint:"interactive"}),E=e.createMediaStreamSource(await navigator.mediaDevices.getUserMedia({video:!1,audio:{echoCancellation:!0,noiseSuppression:!0,channelCount:1}})),z=await t.createTransferer(e,19200),m,c;b="";let A=a=>{y.textContent=` ${JSON.parse(a.detail).partial}`},B=a=>{y.textContent="";l.textContent+=` ${JSON.parse(a.detail).text}`};for await(let [a,f]of v.entries()){let g=await (await (await f.getFileHandle("id")).getFile()).text();b+=`<tr><td>${a}</td><td>${g}</td><td class="delete">[x]</td></tr>`}d.innerHTML+=b;for(let a of document.getElementsByClassName("delete"))a.addEventListener("click",u,{once:!0});z.port.onmessage=a=>c.acceptWaveform(a.data);w.onchange=()=>{C.style.display=w.checked?"block":"none"};D.onclick=()=>l.textContent="";p.onclick=async()=>{for(let a of k.files){let f=await e.decodeAudioData(await a.arrayBuffer());c.acceptWaveform(f.getChannelData(0))}k.value=null};q.onclick=async()=>{"block"==h.style.display?(h.style.display="none",r.style.display="block",await e.suspend()):(r.style.display="none",h.style.display="block",await e.resume())};n.onclick=async()=>{E.connect(z);"block"==h.style.display&&(h.style.display="none",r.style.display="block");await e.suspend();n.disabled=k.disabled=p.disabled=q.disabled=!0;let a=x.value,f=x.selectedOptions[0].text;var g=a.endsWith("_");g&&(a=a.slice(0,-1));g=`https://${g?"ccoreilly.github.io/vosk-browser":"msqr1.github.io/Vosklet"}/models/${a}.tar.gz`;null!=m&&(c.removeEventListener("result",B),c.removeEventListener("partialResult",A),await c.delete(),m.delete());m=await t.createModel(g,f,a);a:{for(let F of d.childNodes)if(f==F.firstChild.textContent)break a;d.innerHTML+=`<tr><td>${f}</td><td>${a}</td><td class="delete">[x]</td></tr>`;d.lastChild.lastChild.addEventListener("click",u,{once:!0})}c=await t.createRecognizer(m,e.sampleRate);c.addEventListener("result",B);c.addEventListener("partialResult",A);n.disabled=k.disabled=p.disabled=q.disabled=!1}});</script>