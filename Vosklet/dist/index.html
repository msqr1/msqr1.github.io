<!doctype html><html lang=en><meta charset=UTF-8 content="width=device-width,initial-scale=1" name=viewport><title>Vosklet Demo</title><script defer src=https://cdn.jsdelivr.net/gh/msqr1/Vosklet@1.1.4/Examples/Vosklet.min.js></script><style>body{font-size:1.3rem;box-sizing:border-box}button,input,select{vertical-align:middle;font-size:1rem}#loadBtn{margin-right:1.25rem}#spkBtn{text-align:center;padding:5px}#micOff,#micOn{width:1.6rem;height:1.6rem}#micOn,#cacheTbl{display:none}h1,h3{text-align:center}#result{border:1px solid grey;width:100%;overflow-wrap:break-word;white-space:normal;min-height:1.56rem}#result>span{white-space:normal;color:grey}#flexbox{--gap:1.5%;justify-content:center;display:flex;flex-wrap:wrap;column-gap:var(--gap)}#flexbox>div{width:100%}#flexbox>div>div{margin-bottom:1.2rem}table{background:#000;width:100%}td{background:#fff}th{background:#d3d3d3}.delete{text-align:center}.delete:hover{background:#ffbdbd}</style><h1>Vosklet 1.1.4 Demo</h1><div id=flexbox><div><h3>Speech Recognition</h3><div><label for=langPick>Language:</label><select id=langPick><option value=vosk-model-small-en-us-0.15_>English<option value=vosk-model-small-en-in-0.4_>Indian English<option value=vosk-model-small-cn-0.3_>Chinese<option value=vosk-model-small-ru-0.4_>Russian<option value=vosk-model-small-fr-pguyot-0.3_>French<option value=vosk-model-small-de-0.15_>German<option value=vosk-model-small-ca-0.4_>Catalan<option value=vosk-model-small-pt-0.3_>Portuguese<option value=vosk-model-small-tr-0.3_>Turkish<option value=vosk-model-small-it-0.4_>Italian<option value=vosk-model-small-es-0.42>Spanish<option value=vosk-model-small-vn-0.4>Vietnamese<option value=vosk-model-small-nl-0.22>Dutch<option value=vosk-model-small-fa-0.5>Farsi<option value=vosk-model-small-kz-0.15>Kazakh<option value=vosk-model-small-ja-0.22>Japanese<option value=vosk-model-small-hi-0.22>Hindi<option value=vosk-model-small-cs-0.4-rhasspy>Czech<option value=vosk-model-small-uz-0.22>Uzbek<option value=vosk-model-small-ko-0.22>Korean<option value=vosk-model-small-tg-0.22>Tajik</select><button id=loadBtn>Load</button><label for=cacheBtn>Show model cache:</label><input id=cacheBtn type=checkbox></div><div><label for=spkBtn>Toggle microphone:</label><button id=spkBtn disabled><img id=micOn src=https://cdn.jsdelivr.net/gh/msqr1/msqr1.github.io/Vosklet/micOn.svg><img id=micOff src=https://cdn.jsdelivr.net/gh/msqr1/msqr1.github.io/Vosklet/micOff.svg></button></div><div><label for=uploadBtn>Upload audio:</label><input id=uploadBtn type=file disabled multiple><button id=processBtn disabled>Process</button></div><div><label for=clrBtn>Result text:</label><button id=clrBtn>Clear</button></div><div id=result><span></span></div></div><div id=cacheTbl><h3>Cached Models</h3><table><thead><tr><th>Path<th>ID<th>Delete (click)<tbody></table></div></div><script>'use strict';document.addEventListener("DOMContentLoaded",async()=>{async function t(){await u.removeEntry(this.parentNode.firstChild.textContent,{recursive:!0});c.removeChild(this.parentNode)}let c=document.getElementsByTagName("tbody")[0],C=document.getElementById("cacheTbl"),v=document.getElementById("cacheBtn"),w=document.getElementById("langPick"),m=document.getElementById("loadBtn"),h=document.getElementById("uploadBtn"),n=document.getElementById("processBtn"),p=document.getElementById("spkBtn"),D=document.getElementById("clrBtn"),g=document.getElementById("micOn"),q=document.getElementById("micOff"),k=document.getElementById("result"),x=k.lastChild,u=await navigator.storage.getDirectory(),r=await loadVosklet(),e=new AudioContext({sampleRate:16E3,sinkId:{type:"none"},latencyHint:"interactive"}),E=e.createMediaStreamSource(await navigator.mediaDevices.getUserMedia({video:!1,audio:{echoCancellation:!0,noiseSuppression:!0,channelCount:1,sampleRate:16E3}})),y=await r.createTransferer(e,19200),l,b,z="",A=a=>{x.textContent=` ${JSON.parse(a.detail).partial}`},B=a=>{x.textContent="";k.textContent+=` ${JSON.parse(a.detail).text}`};for await(let [a,d]of u.entries()){let f=await (await (await d.getFileHandle("id")).getFile()).text();z+=`<tr><td>${a}</td><td>${f}</td><td class="delete">[x]</td></tr>`}c.innerHTML+=z;for(let a of document.getElementsByClassName("delete"))a.addEventListener("click",t,{once:!0});y.port.onmessage=a=>b.acceptWaveform(a.data);v.onchange=()=>{C.style.display=v.checked?"block":"none"};D.onclick=()=>k.textContent="";n.onclick=async()=>{for(let a of h.files){let d=await e.decodeAudioData(await a.arrayBuffer());b.acceptWaveform(d.getChannelData(0))}h.value=null};p.onclick=async()=>{"block"==g.style.display?(g.style.display="none",q.style.display="block",await e.suspend()):(q.style.display="none",g.style.display="block",await e.resume())};m.onclick=async()=>{E.connect(y);"block"==g.style.display&&(g.style.display="none",q.style.display="block");await e.suspend();m.disabled=h.disabled=n.disabled=p.disabled=!0;let a=w.value,d=w.selectedOptions[0].text;var f=a.endsWith("_");f&&(a=a.slice(0,-1));f=`https://${f?"ccoreilly.github.io/vosk-browser":"msqr1.github.io/Vosklet"}/models/${a}.tar.gz`;null!=l&&(b.removeEventListener("result",B),b.removeEventListener("partialResult",A),await b.delete(),l.delete());l=await r.createModel(f,d,a);a:{for(let F of c.childNodes)if(d==F.firstChild.textContent)break a;c.innerHTML+=`<tr><td>${d}</td><td>${a}</td><td class="delete">[x]</td></tr>`;c.lastChild.lastChild.addEventListener("click",t,{once:!0})}b=await r.createRecognizer(l,16E3);b.addEventListener("result",B);b.addEventListener("partialResult",A);m.disabled=h.disabled=n.disabled=p.disabled=!1}});</script>