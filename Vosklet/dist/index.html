<!Doctype html><html lang=en><meta charset=UTF-8 content="width=device-width,initial-scale=1"name=viewport><title>Vosklet Demo</title><script defer src=https://cdn.jsdelivr.net/gh/msqr1/Vosklet@1.1.4/Examples/Vosklet.min.js></script><style>body{font-size:1.3rem;box-sizing:border-box}button,input,select{vertical-align:middle;font-size:1rem}#loadBtn{margin-right:1.25rem}#spkBtn{text-align:center;padding:5px}#micOff,#micOn{width:1.6rem;height:1.6rem}#micOn{display:none}h1,h3{text-align:center}#result{border:1px solid grey;width:100%;overflow-wrap:break-word;white-space:normal;min-height:1.56rem}#result>span{white-space:normal;color:grey}#flexbox{--gap:1.5%;justify-content:center;display:flex;flex-wrap:wrap;column-gap:var(--gap)}#flexbox>div{width:100%}#flexbox>div>div{margin-bottom:1.2rem}table{background:#000;width:100%}td{background:#fff}th{background:#d3d3d3}.delete{text-align:center}.delete:hover{background:#ffbdbd}</style><h1>Vosklet 1.1.4 Demo</h1><div id=flexbox><div><h3>Speech Recognition</h3><div><label for=langPick>Language:</label> <select id=langPick><option value=vosk-model-small-en-us-0.15>English<option value=vosk-model-small-en-in-0.4>Indian English<option value=vosk-model-small-cn-0.22>Chinese<option value=vosk-model-small-ru-0.22>Russian<option value=vosk-model-small-fr-0.22>French<option value=vosk-model-small-de-0.15>German<option value=vosk-model-small-es-0.42>Spanish<option value=vosk-model-small-pt-0.3>Portuguese<option value=vosk-model-small-tr-0.3>Turkish<option value=vosk-model-small-vn-0.4>Vietnamese<option value=vosk-model-small-it-0.22>Italian<option value=vosk-model-small-nl-0.22>Dutch<option value=vosk-model-small-ca-0.4>Catalan<option value=vosk-model-small-fa-0.5>Farsi<option value=vosk-model-small-uk-v3-nano>Ukrainian<option value=vosk-model-small-kz-0.15>Kazakh<option value=vosk-model-small-ja-0.22>Japanese<option value=vosk-model-small-eo-0.42>Esperanto<option value=vosk-model-small-hi-0.22>Hindi<option value=vosk-model-small-cs-0.4-rhasspy>Czech<option value=vosk-model-small-pl-0.22>Polish<option value=vosk-model-small-uz-0.22>Uzbek<option value=vosk-model-small-ko-0.22>Korean<option value=vosk-model-br-0.8>Breton<option value=vosk-model-small-gu-0.42>Gujarati<option value=vosk-model-small-tg-0.22>Tajik</select> <button id=loadBtn>Load</button> <label for=cacheBtn>Show model cache:</label> <input id=cacheBtn type=checkbox></div><div><label for=spkBtn>Toggle microphone:</label> <button id=spkBtn disabled><img id=micOn src=micOn.svg><img id=micOff src=micOff.svg></button></div><div><label for=uploadBtn>Upload audio:</label> <input id=uploadBtn type=file disabled multiple> <button id=processBtn disabled>Process</button></div><div><label for=clrBtn>Result text:</label> <button id=clrBtn>Clear</button></div><div id=result><span></span></div></div><div id=cacheTbl><h3>Cached Models</h3><table><thead><tr><th>Path<th>ID<th>Delete (click)<tbody></table></div></div><script>'use strict';document.addEventListener("DOMContentLoaded",async()=>{async function t(){await u.removeEntry(this.parentNode.firstChild.textContent,{recursive:!0});c.removeChild(this.parentNode)}let c=document.getElementsByTagName("tbody")[0],C=document.getElementById("cacheTbl"),v=document.getElementById("cacheBtn"),w=document.getElementById("langPick"),l=document.getElementById("loadBtn"),g=document.getElementById("uploadBtn"),m=document.getElementById("processBtn"),n=document.getElementById("spkBtn"),
D=document.getElementById("clrBtn"),f=document.getElementById("micOn"),p=document.getElementById("micOff"),h=document.getElementById("result"),x=h.lastChild,u=await navigator.storage.getDirectory(),q=await loadVosklet(),e=new AudioContext({sampleRate:16E3,sinkId:{type:"none"},latencyHint:"interactive"}),E=e.createMediaStreamSource(await navigator.mediaDevices.getUserMedia({video:!1,audio:{echoCancellation:!0,noiseSuppression:!0,channelCount:1,sampleRate:16E3}})),y=await q.createTransferer(e,19200),
k,b,z="",A=a=>{x.textContent=` ${JSON.parse(a.detail).partial}`},B=a=>{x.textContent="";h.textContent+=` ${JSON.parse(a.detail).text}`};for await(let [a,d]of u.entries()){let r=await (await (await d.getFileHandle("id")).getFile()).text();z+=`<tr><td>${a}</td><td>${r}</td><td class="delete">[x]</td></tr>`}c.innerHTML+=z;for(let a of document.getElementsByClassName("delete"))a.addEventListener("click",t,{once:!0});y.port.onmessage=a=>b.acceptWaveform(a.data);v.onchange=()=>{C.style.display=v.checked?
"block":"none"};D.onclick=()=>h.textContent="";m.onclick=async()=>{for(let a of g.files){let d=await e.decodeAudioData(await a.arrayBuffer());b.acceptWaveform(d.getChannelData(0))}g.value=null};n.onclick=async()=>{"block"==f.style.display?(f.style.display="none",p.style.display="block",await e.suspend()):(p.style.display="none",f.style.display="block",await e.resume())};l.onclick=async()=>{E.connect(y);"block"==f.style.display&&(f.style.display="none",p.style.display="block");await e.suspend();l.disabled=
g.disabled=m.disabled=n.disabled=!0;let a=w.value,d=w.selectedOptions[0].text,r=`Models/${a}.tar.gz`;null!=k&&(b.removeEventListener("result",B),b.removeEventListener("partialResult",A),await b.delete(),k.delete());k=await q.createModel(r,d,a);a:{for(let F of c.childNodes)if(d==F.firstChild.textContent)break a;c.innerHTML+=`<tr><td>${d}</td><td>${a}</td><td class="delete">[x]</td></tr>`;c.lastChild.lastChild.addEventListener("click",t,{once:!0})}b=await q.createRecognizer(k,16E3);b.addEventListener("result",
B);b.addEventListener("partialResult",A);l.disabled=g.disabled=m.disabled=n.disabled=!1}});</script>